{"ast":null,"code":"var _jsxFileName = \"/Users/vishnuvamsithyejju/Downloads/Disaster_Management-master/client/src/components/Alert.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\nimport customMarkerIconImage from '../../src/assets/home/mark.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Popup() {\n  _s();\n\n  const [isOpen, setIsOpen] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [userLocation, setUserLocation] = useState(null);\n  const [nearbySafePlaces, setNearbySafePlaces] = useState([]);\n  const [isRequestingHelp, setIsRequestingHelp] = useState(false);\n  const [emergencyType, setEmergencyType] = useState('');\n  const [mapInitialized, setMapInitialized] = useState(false);\n  useEffect(() => {\n    const popupTimeout = setTimeout(() => {\n      setIsOpen(false);\n    }, 10000); // Close popup after 10 seconds\n\n    return () => clearTimeout(popupTimeout);\n  }, []);\n  useEffect(() => {\n    let map;\n\n    if (mapInitialized) {\n      if (!window.myMap) {\n        map = L.map('map', {\n          center: userLocation ? [userLocation.latitude, userLocation.longitude] : [17.46821, 78.373056],\n          zoom: 13\n        });\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          maxZoom: 19,\n          attribution: 'Â© OpenStreetMap'\n        }).addTo(map);\n        window.myMap = map;\n      } else {\n        map = window.myMap;\n        map.eachLayer(layer => {\n          if (layer instanceof L.Marker) {\n            map.removeLayer(layer);\n          }\n        });\n      }\n\n      nearbySafePlaces.forEach(place => {\n        L.marker([place.latitude, place.longitude], {\n          icon: new L.Icon({\n            iconUrl: customMarkerIconImage,\n            iconSize: [25, 41],\n            iconAnchor: [12, 41],\n            popupAnchor: [1, -34]\n          })\n        }).addTo(map).bindPopup(`<b>${place.Name}</b>`).openPopup();\n      });\n    }\n\n    return () => {\n      if (map) {\n        map.off();\n        map.remove();\n        window.myMap = null;\n      }\n    };\n  }, [mapInitialized, nearbySafePlaces, userLocation]);\n\n  const handleClose = () => {\n    setIsOpen(false);\n  };\n\n  const handleEmergencyClick = () => {\n    setIsSending(true);\n    navigator.geolocation.getCurrentPosition(async position => {\n      const {\n        latitude,\n        longitude\n      } = position.coords;\n\n      try {\n        const response = await axios.post('http://localhost:5002/emergency/Location', {\n          latitude,\n          longitude,\n          emergencyType\n        });\n        console.log('Emergency location sent:', response.data.message);\n      } catch (error) {\n        console.error('Error sending emergency location:', error);\n      } finally {\n        setIsSending(false);\n      }\n    }, error => {\n      console.error('Geolocation error:', error);\n      setIsSending(false);\n    });\n  };\n\n  const handleHelpRequest = () => {\n    setIsRequestingHelp(true);\n    setIsSending(true);\n    navigator.geolocation.getCurrentPosition(async position => {\n      const {\n        latitude,\n        longitude\n      } = position.coords;\n      console.log(latitude);\n      setUserLocation({\n        latitude,\n        longitude\n      });\n\n      try {\n        const response = await axios.get(`http://localhost:8086/alert/nearby-safe-places`, {\n          params: {\n            latitude,\n            longitude\n          }\n        });\n        setNearbySafePlaces(response.data.nearbySafePlaces);\n        setMapInitialized(true);\n      } catch (error) {\n        console.error('Error fetching nearby safe places:', error);\n      } finally {\n        setIsSending(false);\n        setIsRequestingHelp(false);\n      }\n    }, error => {\n      console.error('Geolocation error:', error);\n      setIsRequestingHelp(false);\n    });\n  };\n\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\n      zIndex: 9999\n    },\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        backgroundColor: '#fff',\n        padding: '20px',\n        boxShadow: '0 4px 8px 0 rgba(0, 0, 0, 0.2)',\n        textAlign: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        style: {\n          position: 'absolute',\n          top: '10px',\n          right: '10px',\n          fontSize: '24px',\n          cursor: 'pointer'\n        },\n        onClick: handleClose,\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"WELCOME TO DISASTER RESILIENCE!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        placeholder: \"Type of Emergency\",\n        value: emergencyType,\n        onChange: e => setEmergencyType(e.target.value),\n        style: {\n          margin: '10px 0'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleEmergencyClick,\n        disabled: isSending,\n        style: {\n          backgroundColor: 'red',\n          color: '#fff',\n          border: 'none',\n          borderRadius: '5px',\n          padding: '10px 20px',\n          cursor: 'pointer'\n        },\n        children: isSending ? 'Sending...' : 'EMERGENCY'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleHelpRequest,\n        disabled: isSending,\n        style: {\n          backgroundColor: 'blue',\n          color: '#fff',\n          padding: '10px 20px',\n          margin: '10px',\n          cursor: 'pointer'\n        },\n        children: \"Request Help\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 9\n      }, this), mapInitialized && /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"map\",\n        style: {\n          height: '400px',\n          width: '100%'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 28\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Popup, \"WiTFyBhkaZm3NkP/t6tDeVH+IpM=\");\n\n_c = Popup;\nexport default Popup;\n\nvar _c;\n\n$RefreshReg$(_c, \"Popup\");","map":{"version":3,"sources":["/Users/vishnuvamsithyejju/Downloads/Disaster_Management-master/client/src/components/Alert.jsx"],"names":["React","useState","useEffect","axios","L","customMarkerIconImage","Popup","isOpen","setIsOpen","isSending","setIsSending","userLocation","setUserLocation","nearbySafePlaces","setNearbySafePlaces","isRequestingHelp","setIsRequestingHelp","emergencyType","setEmergencyType","mapInitialized","setMapInitialized","popupTimeout","setTimeout","clearTimeout","map","window","myMap","center","latitude","longitude","zoom","tileLayer","maxZoom","attribution","addTo","eachLayer","layer","Marker","removeLayer","forEach","place","marker","icon","Icon","iconUrl","iconSize","iconAnchor","popupAnchor","bindPopup","Name","openPopup","off","remove","handleClose","handleEmergencyClick","navigator","geolocation","getCurrentPosition","position","coords","response","post","console","log","data","message","error","handleHelpRequest","get","params","display","justifyContent","alignItems","top","left","width","height","backgroundColor","zIndex","padding","boxShadow","textAlign","right","fontSize","cursor","e","target","value","margin","color","border","borderRadius"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport L from 'leaflet';\nimport 'leaflet/dist/leaflet.css';\n\nimport customMarkerIconImage from '../../src/assets/home/mark.png';\n\nfunction Popup() {\n  const [isOpen, setIsOpen] = useState(true);\n  const [isSending, setIsSending] = useState(false);\n  const [userLocation, setUserLocation] = useState(null);\n  const [nearbySafePlaces, setNearbySafePlaces] = useState([]);\n  const [isRequestingHelp, setIsRequestingHelp] = useState(false);\n  const [emergencyType, setEmergencyType] = useState('');\n  const [mapInitialized, setMapInitialized] = useState(false);\n\n  useEffect(() => {\n    const popupTimeout = setTimeout(() => {\n      setIsOpen(false);\n    }, 10000); // Close popup after 10 seconds\n\n    return () => clearTimeout(popupTimeout);\n  }, []);\n\n  useEffect(() => {\n    let map;\n\n    if (mapInitialized) {\n      if (!window.myMap) {\n        map = L.map('map', {\n          center: userLocation ? [userLocation.latitude, userLocation.longitude] : [17.46821, 78.373056],\n          zoom: 13,\n        });\n        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n          maxZoom: 19,\n          attribution: 'Â© OpenStreetMap'\n        }).addTo(map);\n        window.myMap = map;\n      } else {\n        map = window.myMap;\n        map.eachLayer((layer) => {\n          if (layer instanceof L.Marker) {\n            map.removeLayer(layer);\n          }\n        });\n      }\n\n      nearbySafePlaces.forEach(place => {\n        L.marker([place.latitude, place.longitude], {\n          icon: new L.Icon({\n            iconUrl: customMarkerIconImage,\n            iconSize: [25, 41],\n            iconAnchor: [12, 41],\n            popupAnchor: [1, -34]\n          })\n        }).addTo(map)\n        .bindPopup(`<b>${place.Name}</b>`)\n        .openPopup();\n      });\n    }\n\n    return () => {\n      if (map) {\n        map.off();\n        map.remove();\n        window.myMap = null;\n      }\n    };\n  }, [mapInitialized, nearbySafePlaces, userLocation]);\n\n  const handleClose = () => {\n    setIsOpen(false);\n  };\n\n  const handleEmergencyClick = () => {\n    setIsSending(true);\n    navigator.geolocation.getCurrentPosition(async (position) => {\n      const { latitude, longitude } = position.coords;\n      try {\n        const response = await axios.post('http://localhost:5002/emergency/Location', {\n          latitude,\n          longitude,\n          emergencyType,\n        });\n        console.log('Emergency location sent:', response.data.message);\n      } catch (error) {\n        console.error('Error sending emergency location:', error);\n      } finally {\n        setIsSending(false);\n      }\n    }, (error) => {\n      console.error('Geolocation error:', error);\n      setIsSending(false);\n    });\n  };\n\n  const handleHelpRequest = () => {\n    setIsRequestingHelp(true);\n    setIsSending(true);\n    navigator.geolocation.getCurrentPosition(async (position) => {\n      const { latitude, longitude } = position.coords;\n      console.log(latitude)\n      setUserLocation({ latitude, longitude });\n      try {\n        const response = await axios.get(`http://localhost:8086/alert/nearby-safe-places`, {\n          params: { latitude, longitude }\n        });\n        setNearbySafePlaces(response.data.nearbySafePlaces);\n        setMapInitialized(true);\n      } catch (error) {\n        console.error('Error fetching nearby safe places:', error);\n      } finally {\n        setIsSending(false);\n        setIsRequestingHelp(false);\n      }\n    }, (error) => {\n      console.error('Geolocation error:', error);\n      setIsRequestingHelp(false);\n    });\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div style={{\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n      height: '100%',\n      backgroundColor: 'rgba(0, 0, 0, 0.5)',\n      zIndex: 9999,\n    }}>\n      <div style={{\n        backgroundColor: '#fff',\n        padding: '20px',\n        boxShadow: '0 4px 8px 0 rgba(0, 0, 0, 0.2)',\n        textAlign: 'center',\n      }}>\n        <span style={{\n          position: 'absolute',\n          top: '10px',\n          right: '10px',\n          fontSize: '24px',\n          cursor: 'pointer',\n        }} onClick={handleClose}>&times;</span>\n        <h1>WELCOME TO DISASTER RESILIENCE!</h1>\n        <input\n          type=\"text\"\n          placeholder=\"Type of Emergency\"\n          value={emergencyType}\n          onChange={(e) => setEmergencyType(e.target.value)}\n          style={{ margin: '10px 0' }}\n        />\n        <button onClick={handleEmergencyClick} disabled={isSending} style={{\n          backgroundColor: 'red',\n          color: '#fff',\n          border: 'none',\n          borderRadius: '5px',\n          padding: '10px 20px',\n          cursor: 'pointer',\n        }}>\n          {isSending ? 'Sending...' : 'EMERGENCY'}\n        </button>\n        <button onClick={handleHelpRequest} disabled={isSending} style={{\n          backgroundColor: 'blue',\n          color: '#fff',\n          padding: '10px 20px',\n          margin: '10px',\n          cursor: 'pointer',\n        }}>\n          Request Help\n        </button>\n        {mapInitialized && <div id=\"map\" style={{ height: '400px', width: '100%' }}></div>}\n      </div>\n    </div>\n  );\n}\n\nexport default Popup;\n"]},"metadata":{},"sourceType":"module"}